2025-09-04 09:52:24 [Info] Starting Microsoft 365 External User Audit...
2025-09-04 09:52:24 [Info] Output Path: .\AuditReports
2025-09-04 09:52:24 [Info] Step 1/7: Authenticating to Microsoft 365...
2025-09-04 09:52:24 [Info] üîê Initiating Microsoft 365 authentication sequence...
2025-09-04 09:52:24 [Info] Connecting to Microsoft Graph...
2025-09-04 09:54:26 [Success] ‚úÖ Connected to Microsoft Graph as: 
2025-09-04 09:54:26 [Info] Connecting to SharePoint Online...
2025-09-04 09:54:26 [Info] Using SharePoint Admin URL: https://m365x22747677-admin.sharepoint.com
2025-09-04 09:55:14 [Success] ‚úÖ Connected to SharePoint Online: https://m365x22747677-admin.sharepoint.com
2025-09-04 09:55:14 [Info] Connecting to Exchange Online...
2025-09-04 09:55:14 [Warning] Warning: Could not connect to Exchange Online. Continuing with limited functionality...
2025-09-04 09:55:14 [Warning] Exchange Online error: Unable to load DLL 'msalruntime' or one of its dependencies: The specified module could not be found. (0x8007007E) See https://aka.ms/msal-net-wam#troubleshooting
2025-09-04 09:55:14 [Success] ‚úÖ All services connected successfully
2025-09-04 09:55:14 [Info] Step 2/7: Discovering external users...
2025-09-04 09:55:14 [Info] üîç Discovering external users in tenant...
2025-09-04 09:55:14 [Info] Found 0 guest users in Azure AD
2025-09-04 09:55:16 [Success] Total external users discovered: 1
2025-09-04 09:55:16 [Info] Step 3/7: Analyzing SharePoint site access...
2025-09-04 09:55:16 [Info] üìÇ Analyzing SharePoint site access...
2025-09-04 09:55:42 [Warning] Error processing site: https://m365x22747677.sharepoint.com/sites/SalesPlanning
2025-09-04 09:55:44 [Success] ‚úÖ SharePoint site analysis complete
2025-09-04 09:55:44 [Info] Step 4/7: Analyzing Microsoft Teams access...
2025-09-04 09:55:44 [Info] üë• Analyzing Microsoft Teams access...
2025-09-04 09:55:44 [Success] ‚úÖ Teams analysis complete
2025-09-04 09:55:44 [Info] Step 5/7: Analyzing Microsoft 365 Group memberships...
2025-09-04 09:55:44 [Info] üìä Analyzing Microsoft 365 Group memberships...
2025-09-04 09:55:44 [Success] ‚úÖ Microsoft 365 Groups analysis complete
2025-09-04 09:55:44 [Info] Step 6/7: Analyzing site sharing settings...
2025-09-04 09:55:44 [Info] üîó Analyzing site sharing settings...
2025-09-04 09:55:46 [Success] ‚úÖ Site sharing settings analysis complete
2025-09-04 09:55:46 [Info] Step 7/7: Analyzing guest expiration...
2025-09-04 09:55:46 [Info] ‚è∞ Analyzing guest expiration settings...
2025-09-04 09:55:46 [Success] ‚úÖ Guest expiration analysis complete
2025-09-04 09:55:46 [Info] üìÑ Generating audit reports...
2025-09-04 09:55:46 [Success] ‚úÖ Main report exported: .\AuditReports\ExternalUserAudit_Main_20250904_095546.csv
2025-09-04 09:55:46 [Success] ‚úÖ Sharing settings report exported: .\AuditReports\SiteSharingSettings_20250904_095546.csv
2025-09-04 09:55:46 [Success] ‚úÖ Guest expiration report exported: .\AuditReports\GuestExpiration_20250904_095546.csv
2025-09-04 09:55:46 [Success] ‚úÖ Executive summary generated: .\AuditReports\ExecutiveSummary_20250904_095546.md
2025-09-04 09:55:46 [Success] ‚úÖ All reports generated successfully
2025-09-04 09:55:46 [Info] Disconnecting from Microsoft 365 services...
2025-09-04 10:28:49 [Info] Starting Microsoft 365 External User Audit...
2025-09-04 10:28:49 [Info] Output Path: .\AuditReports
2025-09-04 10:28:49 [Info] Step 1/7: Authenticating to Microsoft 365...
2025-09-04 10:28:49 [Info] üîê Initiating Microsoft 365 authentication sequence...
2025-09-04 10:28:49 [Info] Connecting to Microsoft Graph...
2025-09-04 10:30:53 [Success] ‚úÖ Connected to Microsoft Graph as: admin@M365x22747677.onmicrosoft.com
2025-09-04 10:30:53 [Info] Connecting to SharePoint Online...
2025-09-04 10:30:58 [Info] Using SharePoint Admin URL: https://m365x22747677-admin.sharepoint.com
2025-09-04 10:30:58 [Error] Failed to connect to SharePoint Online: Specified method is not supported.
2025-09-04 10:30:58 [Warning] Will continue with limited SharePoint functionality...
2025-09-04 10:30:58 [Info] Connecting to Exchange Online...
2025-09-04 10:30:59 [Warning] Warning: Could not connect to Exchange Online. Continuing with limited functionality...
2025-09-04 10:30:59 [Warning] Exchange Online error: Unable to load DLL 'msalruntime' or one of its dependencies: The specified module could not be found. (0x8007007E) See https://aka.ms/msal-net-wam#troubleshooting
2025-09-04 10:30:59 [Success] ‚úÖ Service connection process complete
2025-09-04 10:30:59 [Info] Step 2/7: Discovering external users...
2025-09-04 10:30:59 [Info] üîç Discovering external users in tenant...
2025-09-04 10:30:59 [Info] Attempting to retrieve guest users from Azure AD...
2025-09-04 10:30:59 [Warning] Primary Graph query failed: Could not load type 'Microsoft.Graph.Authentication.AzureIdentityAccessTokenProvider' from assembly 'Microsoft.Graph.Core, Version=1.25.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.
2025-09-04 10:30:59 [Info] Attempting alternative approach...
2025-09-04 10:30:59 [Error] Alternative Graph query also failed: Could not load type 'Microsoft.Graph.Authentication.AzureIdentityAccessTokenProvider' from assembly 'Microsoft.Graph.Core, Version=1.25.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.
2025-09-04 10:30:59 [Info] Found 0 guest users in Azure AD
2025-09-04 10:30:59 [Warning] SharePoint PnP module not available, skipping SharePoint external user discovery
2025-09-04 10:30:59 [Success] Total external users discovered: 0
2025-09-04 10:30:59 [Warning] No external users found. This could indicate:
2025-09-04 10:30:59 [Warning]   1. No external users exist in the tenant
2025-09-04 10:30:59 [Warning]   2. Insufficient permissions to view external users
2025-09-04 10:30:59 [Warning]   3. Module or authentication issues
2025-09-04 10:30:59 [Warning] No external users found in the tenant
